### Events API Testing
### Base URL
@baseUrl = http://localhost:3000/api
@accessToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6Ijk2MjU0ZDFkLWZmMWQtNDQyZi1iODgwLTFlYTAyZDgyODU0NSIsImVtYWlsIjoidGVzdDJAZXhhbXBsZS5jb20iLCJyb2xlIjoiQURNSU4iLCJpYXQiOjE3NjYzNTE0OTd9.vYtFWa5wmSDw4divu5uyy2Lb9Qvho8A-10koX_GLBTU

### Variables will be set from responses
# After login, copy the accessToken value here

################################################################################
# 1. GET ALL EVENTS (Public)
################################################################################

### Get all events - no auth required
GET {{baseUrl}}/events
Content-Type: application/json

### Get events with pagination
GET {{baseUrl}}/events?page=1&limit=10
Content-Type: application/json

### Get events with status filter
GET {{baseUrl}}/events?status=ACTIVE
Content-Type: application/json

### Get events with date range
GET {{baseUrl}}/events?startDate=2025-01-01T00:00:00Z&endDate=2025-12-31T23:59:59Z
Content-Type: application/json

### Get events with search
GET {{baseUrl}}/events?search=conference
Content-Type: application/json

### Get events with sorting
GET {{baseUrl}}/events?sortBy=startDate&order=desc
Content-Type: application/json

### Get events with multiple filters
GET {{baseUrl}}/events?status=ACTIVE&page=1&limit=5&sortBy=startDate&order=asc
Content-Type: application/json

################################################################################
# 2. GET SINGLE EVENT (Public)
################################################################################

### Get event by ID (replace with actual ID)
GET {{baseUrl}}/events/123e4567-e89b-12d3-a456-426614174000
Content-Type: application/json

### Get non-existent event (should return 404)
GET {{baseUrl}}/events/00000000-0000-0000-0000-000000000000
Content-Type: application/json

################################################################################
# 3. GET EVENT STATISTICS (Public)
################################################################################

### Get event stats (replace with actual ID)
GET {{baseUrl}}/events/123e4567-e89b-12d3-a456-426614174000/stats
Content-Type: application/json

################################################################################
# 4. CREATE EVENT (Protected - ADMIN/ORGANIZER)
################################################################################

### Create new event - Valid (requires auth token)
POST {{baseUrl}}/events
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "name": "Annual Tech Conference 2025",
  "location": "Convention Center, Downtown",
  "startDate": "2025-06-15T09:00:00Z",
  "endDate": "2025-06-17T18:00:00Z",
  "status": "ACTIVE",
  "participantFields": [
    {
      "name": "firstName",
      "type": "text",
      "label": "First Name",
      "required": true
    },
    {
      "name": "lastName",
      "type": "text",
      "label": "Last Name",
      "required": true
    },
    {
      "name": "email",
      "type": "email",
      "label": "Email Address",
      "required": true
    },
    {
      "name": "phone",
      "type": "phone",
      "label": "Phone Number",
      "required": false
    },
    {
      "name": "organization",
      "type": "text",
      "label": "Organization",
      "required": false
    }
  ]
}

### Create event - Missing required fields
POST {{baseUrl}}/events
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "name": "Incomplete Event"
}

### Create event - Invalid date range (end before start)
POST {{baseUrl}}/events
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "name": "Invalid Date Event",
  "location": "Test Location",
  "startDate": "2025-06-17T18:00:00Z",
  "endDate": "2025-06-15T09:00:00Z",
  "participantFields": []
}

### Create event - Without authentication (should return 401)
POST {{baseUrl}}/events
Content-Type: application/json

{
  "name": "Unauthorized Event",
  "location": "Test Location",
  "startDate": "2025-06-15T09:00:00Z",
  "endDate": "2025-06-17T18:00:00Z",
  "participantFields": []
}

################################################################################
# 5. UPDATE EVENT (Protected - ADMIN/ORGANIZER)
################################################################################

### Update event - Valid (replace with actual ID)
PATCH {{baseUrl}}/events/123e4567-e89b-12d3-a456-426614174000
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "name": "Updated Conference Name",
  "status": "ACTIVE"
}

### Update event - Partial update
PATCH {{baseUrl}}/events/123e4567-e89b-12d3-a456-426614174000
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "location": "Updated location only"
}

### Update event - Change dates
PATCH {{baseUrl}}/events/123e4567-e89b-12d3-a456-426614174000
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "startDate": "2025-07-15T09:00:00Z",
  "endDate": "2025-07-17T18:00:00Z"
}

### Update event - Without authentication (should return 401)
PATCH {{baseUrl}}/events/123e4567-e89b-12d3-a456-426614174000
Content-Type: application/json

{
  "name": "Unauthorized Update"
}

### Update non-existent event (should return 404)
PATCH {{baseUrl}}/events/00000000-0000-0000-0000-000000000000
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "title": "Update Non-existent Event"
}

################################################################################
# 6. DELETE EVENT (Protected - ADMIN/ORGANIZER)
################################################################################

### Delete event (replace with actual ID)
DELETE {{baseUrl}}/events/123e4567-e89b-12d3-a456-426614174000
Authorization: Bearer {{accessToken}}

### Delete event - Without authentication (should return 401)
DELETE {{baseUrl}}/events/123e4567-e89b-12d3-a456-426614174000

### Delete non-existent event (should return 404)
DELETE {{baseUrl}}/events/00000000-0000-0000-0000-000000000000
Authorization: Bearer {{accessToken}}

################################################################################
# 7. TEST CONFLICT DETECTION
################################################################################

### Create first event for conflict test
POST {{baseUrl}}/events
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "title": "Morning Workshop",
  "description": "First event in the salle",
  "startDate": "2025-08-20T09:00:00Z",
  "endDate": "2025-08-20T12:00:00Z",
  "salleId": "replace-with-actual-salle-id",
  "status": "ACTIVE"
}

### Create conflicting event (should return 409)
POST {{baseUrl}}/events
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "title": "Conflicting Afternoon Event",
  "description": "This should conflict with the morning workshop",
  "startDate": "2025-08-20T10:00:00Z",
  "endDate": "2025-08-20T14:00:00Z",
  "salleId": "replace-with-actual-salle-id",
  "status": "ACTIVE"
}

################################################################################
# NOTES
################################################################################

# Before testing protected routes:
# 1. Create an account using POST /api/auth/register
# 2. Login using POST /api/auth/login to get access token
# 3. Replace {{accessToken}} variable at the top with your actual token
# 4. Replace salle IDs with actual IDs from your database

# You can get a salle ID by:
# 1. Creating a salle first (if salles CRUD is implemented)
# 2. Or manually inserting a salle in the database
# 3. Or checking existing salles with: SELECT id FROM "Salle" LIMIT 1;
