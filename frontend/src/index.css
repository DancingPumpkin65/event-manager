@tailwind base;
@tailwind components;
@tailwind utilities;

/* ============================================
   Font Display Optimization for LCP
   ============================================
   Forces system fonts to render immediately,
   preventing FOIT (Flash of Invisible Text)
   which blocks LCP on first load.
*/
@layer base {
  html {
    /* Use system font stack with swap behavior */
    font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, 
                 "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", 
                 sans-serif, "Apple Color Emoji", "Segoe UI Emoji", 
                 "Segoe UI Symbol", "Noto Color Emoji";
    /* Ensure text renders immediately with fallback */
    font-display: swap;
    /* Optimize text rendering */
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
}

/* ============================================
   Accessibility: Reduced Motion Support
   ============================================
   Respects user's OS-level motion preferences.
   Users with vestibular disorders or motion sensitivity
   will have animations/transitions disabled or reduced.
*/
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* For users who explicitly want motion */
@media (prefers-reduced-motion: no-preference) {
  /* Smooth scrolling only for users who haven't disabled motion */
  html {
    scroll-behavior: smooth;
  }
}

@layer base {
  body {
    @apply bg-gray-50 text-gray-900 min-h-screen;
    /* Prevent layout shift from scrollbar appearance */
    overflow-y: scroll;
  }
  
  /* Optimize LCP text elements - render immediately */
  h1, h2, h3, .text-2xl, .text-xl, .text-lg {
    font-display: swap;
    /* Reduce font loading impact on layout */
    font-synthesis: none;
  }
}

@layer components {
  .btn {
    @apply px-4 py-2 rounded-md font-medium transition-colors;
  }
  
  .btn-primary {
    @apply bg-blue-600 text-white hover:bg-blue-700;
  }
  
  .btn-secondary {
    @apply bg-gray-200 text-gray-900 hover:bg-gray-300;
  }
  
  .card {
    @apply bg-white rounded-lg shadow p-6;
  }
}

@layer utilities {
  /* Content-visibility utilities for performance optimization on tablets/mobile */
  /* Tells browser to skip rendering of off-screen content until needed */
  
  .content-auto {
    content-visibility: auto;
    /* contain-intrinsic-size provides a placeholder size to avoid layout shifts */
    contain-intrinsic-size: auto 200px;
  }
  
  /* For list items - smaller intrinsic size */
  .content-auto-sm {
    content-visibility: auto;
    contain-intrinsic-size: auto 60px;
  }
  
  /* For cards/large items */
  .content-auto-lg {
    content-visibility: auto;
    contain-intrinsic-size: auto 400px;
  }
  
  /* For badge preview canvas - specific size */
  .content-auto-badge {
    content-visibility: auto;
    contain-intrinsic-size: 300px 400px;
  }

  /* ============================================
     Safe Area Insets for Notched Devices
     ============================================
     Ensures UI elements don't get hidden behind
     notches (iPhone), rounded corners, or home indicators.
  */
  
  /* Safe padding for fixed/sticky elements */
  .safe-top {
    padding-top: env(safe-area-inset-top);
  }
  
  .safe-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }
  
  .safe-left {
    padding-left: env(safe-area-inset-left);
  }
  
  .safe-right {
    padding-right: env(safe-area-inset-right);
  }
  
  .safe-x {
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
  
  .safe-y {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
  }
  
  .safe-all {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
}

/* ============================================
   Skeleton Loading Animations
   ============================================
   Custom shimmer animation for skeleton loaders
   that creates a more engaging loading experience.
*/
@keyframes shimmer {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

.animate-shimmer {
  animation: shimmer 1.5s ease-in-out infinite;
}
